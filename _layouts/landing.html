<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "en" }}">

  {%- include head.html -%}

  <body style="overflow: hidden;">

    {%- include views/header.html -%}

    {%- include functions.html func='log' level='debug' msg='Get icon value' -%}
    {% assign name = 'icon' %}
    {%- include functions.html func='get_value' -%}
    {% assign icon = return %}

    {%- include functions.html func='get_banner' -%}

    {%- if has_banner -%}
      {%- if banner_background -%}
      <style>
        html .page-banner {
          background: {{ banner_background }};
          height: 100vh;
        }
      </style>
      {%- endif -%}

      {%- if banner_opacity -%}
      <style>
        html .page-banner .page-banner-img > *:first-child {
          opacity: {{ banner_opacity }};
        }

        html[data-theme="dark"] .page-banner .page-banner-img > *:first-child {
          opacity: {{ banner_opacity | times: 0.718 }};
        }
      </style>
      {%- endif -%}
      
      <section class="page-banner">
        <div class="page-banner-img">
          {%- if banner_video -%}
            <video
              autoplay=""
              poster="{{ banner_image }}"
              playsinline
            >
              <source src="{{ banner_video }}">
            </video>
            <script>
              (function() {
                var video = document.querySelector('.page-banner .page-banner-img > video');
                var videoPlay = function() {
                  video.play().catch (function() {
                      video.muted = true;
                      video.play();
                    });
                }

                video.onloadstart = function() {
                  video.currentTime = {{ banner_start_at }};
                  video.volume = {{ banner_volume }};
                  video.muted = (video.volume == 0);
                  videoPlay();
                }

                video.onended = function() {
                  video.currentTime = {{ banner_start_at }};
                  video.volume = 0;
                {%- if banner_loop -%}
                  video.play();
                {%- endif -%}
                }
              })();
            </script>
          {%- else -%}
            <div style="background-image: url({{ banner_image }})"></div>
            <img class="img-placeholder" src="{{ banner_image }}">
          {%- endif -%}
        </div>

        <div class="wrapper" style="justify-content: center;">
          <div class="page-banner-default" style="display: flex; justify-content: center; align-items: center;">
            <img title="{{ page.title | escape }} Icon" src="{{ icon }}" onerror="this.style.display='none'" style="max-height: 240px; width: auto; z-index: 100;">
          </div>
        </div>
      </section>
    {%- endif -%}

  </body>
</html>
